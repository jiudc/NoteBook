## 服务注册发现

维护一个登记簿，它管理系统内所有的服务地址。当新的服务启动后，它会向登记簿交代自己的地址信息。服务的依赖方直接向登记簿要ServiceProvider地址即可。当前服务注册的工具有ZooKeeper，Consul，Etcd，还有Netflix的eureka。服务注册有两种方式：客户端注册和第三方注册

### 服务注册（zookeeper）

服务注册是服务自身要负责注册和注销的工作。服务启动后向注册中心注册自身，当服务下线时注销自己。期间还需要和注册中心保持心跳。

### 服务发现

当服务方调用某个服务的时候，可以通过服务的名字取服务注册发现中心获取可用的服务，服务发现中心从内存的服务列表中获取可用的服务，然后负载均衡根据既定的规则选择一个服务将HTTP服务的ip port返回给调用方，如果是grpc则从线程池获取该服务的连接返回给调用者。