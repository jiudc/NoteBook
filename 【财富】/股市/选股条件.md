## 高阴划线

高量线:IF(CURRBARSCOUNT<=CONST(REF(HHVBARS(VOL,60),1)+1)+1,CONST(REF(MAX(OPEN,CLOSE),REF(HHVBARS(VOL,60),1)+1)),DRAWNULL),COLORRED,LINETHICK2;
Z1:=STRCAT(HYBLOCK,' '),NODRAW;

Z2:=STRCAT(Z1,DYBLOCK),NODRAW;

DRAWTEXT(CURRBARSCOUNT<100 AND (C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9,L*0.9999,'高量'),COLORYELLOW;

STICKLINE((C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9,O,C,1,0),COLORYELLOW;
STICKLINE(REF(L,1)>H,H,REF(L,1),5,0),COLORGRAY;
STICKLINE(REF(H,1)<L,L,REF(H,1),5,0),COLORGRAY;
C_: CONST(C),COLORLIRED,POINTDOT;
{现价线}Z3:=STRCAT(Z2,' '),NODRAW;
DRAWTEXT_FIX(ISLASTBAR,0.005,5,0,STRCAT(Z3,GNBLOCK)),COLORBLUE;
实上三一:(MAX(OPEN,CLOSE)-MIN(OPEN,CLOSE))*2/3+MIN(OPEN,CLOSE),NODRAW,COLORMAGENTA;
虚上三一:HIGH-(HIGH-LOW)*0.333,NODRAW;
实二一位:(OPEN+CLOSE)/2,NODRAW,COLORRED;
虚二一:HIGH-(HIGH-LOW)*0.5,NODRAW,COLORBLUE;
实下三一:(MAX(OPEN,CLOSE)-MIN(OPEN,CLOSE))/3+MIN(OPEN,CLOSE),NODRAW,COLORMAGENTA;
虚三二:=HIGH-(HIGH-LOW)*0.666,NODRAW,COLOR8000FF;
TJ:=C<O;
显性假阴:=C>REF(C,1) AND TJ;
隐性假阴:=AMOUNT/V/100>REF(C,1) AND  C< REF(C,1) AND O>REF(C,1)AND NOT(显性假阴) AND TJ;
STICKLINE(显性假阴,OPEN,CLOSE,3,0),COLORMAGENTA;
STICKLINE(隐性假阴,OPEN,CLOSE,3,0),COLORLIRED;
TJJ:=C>=O;
显性假阳:=C<REF(C,1) AND TJJ;
STICKLINE(显性假阳,H,L,0,0),COLORGREEN;
STICKLINE(显性假阳,C,O,1,0),COLORGREEN;
C2:=REF(C,1);
涨停:=IF((C-C2)*100/C2>=(10-0.01*100/C2),1,0);
STICKLINE(涨停,OPEN,CLOSE,3,0),COLORRED;
跌停:=IF((C2-C)*100/C2>=(10-0.01*100/C2),1,0);
STICKLINE(跌停,CLOSE,OPEN,3,0),COLOR00FF00;
STICKLINE(跌停,HIGH,LOW,0,1),COLOR00FF00;
STICKLINE(涨停 AND BETWEEN(CLOSE,1,500),实二一位,实二一位,3,0),COLORBLUE;
STICKLINE(跌停 AND BETWEEN(CLOSE,1,500),实二一位,实二一位,3,0),COLORBLUE;
LD13:=CLOSE>OPEN AND C/REF(C,1)>1.03 AND NOT(涨停);
LD14:=CLOSE<OPEN AND REF(C,1)/C>1.03 AND NOT(跌停);
STICKLINE(LD13 OR LD14 AND BETWEEN(CLOSE,1,500),实二一位,实二一位,3,0),COLORBLUE;
大阴线:=C<0.96*O OR C<=REF(C,1)*0.96 OR C>1000 AND C<=REF(C,1)*0.98;
大阴T:=BARSLAST(FILTER(大阴线,2));
大阴实顶:= REF(O,大阴T);
DRAWLINE(大阴T=0,MAX(C,O),REF(大阴T=0,1),REF(MAX(C,O),1),1),COLORLICYAN;
SB:=MAX(CLOSE,OPEN);
QB:=MIN(CLOSE,OPEN);
跳空:=QB-0.01>=REF(SB,1);
ZDZD:=C>REF((O+C)/2,1) AND REF(C<O OR C<REF(C,1),1);
ZHZD:=BACKSET(ISLASTBAR,BARSLAST(ZDZD));
DRAWTEXT(跳空 AND ZHZD,REF(C,1)-0.001,'O'),COLORBLUE;
阴顶开盘:=REF(C<O,1) AND 跳空;
DRAWTEXT(阴顶开盘,REF(H,1)-0.001,'YD'),COLORFFFF00;
百分比:=5;
右数峰序:=2;
{ZIG(3,5);
}波谷值:CONST(TROUGH(2,百分比,1)),NODRAW;
{前M个ZIG转向波谷值}波谷距离:=1+CONST(TROUGHBARS(2,百分比,1)),NODRAW;
{前M个ZIG转向波谷到当前距离}{例如:TROUGH(2,5,2)表示%5最低价ZIG转向的前2个波谷到当前的周期数};
波峰值:=CONST(PEAK(1,百分比,右数峰序));
M144:=MA(CLOSE,144),COLORBROWN,LINETHICK2;
M233:=MA(CLOSE,233),COLORYELLOW,LINETHICK2;
M377:=MA(CLOSE,377),COLORCYAN,LINETHICK2;
M450:=MA(CLOSE,450),COLORGREEN,LINETHICK2;
M610:=MA(CLOSE,610),COLORRED,LINETHICK2;
A90:=(MA(COST(90),6)),DOTLINE,COLOR808040;
A70:=(MA(COST(70),6)),DOTLINE,COLOR808040;
M20:=MA(CLOSE,20),COLORWHITE,LINETHICK2;
T5:=REF(HHVBARS(HIGH,60),15)+15;
 T60:=REF(HIGH,T5),COLORRED,NODRAW;
STICKLINE(BARSTATUS=2,T60,T60,2000,1),COLORBLUE;
DRAWTEXT(BARSTATUS=2,T60,'强势平台'),COLORYELLOW;

## 高亮划线

DRAWTEXT_FIX(ISLASTBAR,0,0,0,HYBLOCK);{在屏幕左上角显示所属行业板块}
DRAWTEXT_FIX(ISLASTBAR,0.05,0,0,DYBLOCK);{在屏幕左上角显示所属地域板块}
DRAWTEXT_FIX(ISLASTBAR,0.1,0,0,GNBLOCK);{在屏幕左上角显示所属概念板块}
高量线:IF(CURRBARSCOUNT<=CONST(REF(HHVBARS(VOL,60),1)+1)+1,CONST(REF(MAX(OPEN,CLOSE),REF(HHVBARS(VOL,60),1)+1)),DRAWNULL),COLORRED,LINETHICK2;
DRAWTEXT(CURRBARSCOUNT<100 AND (C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9,L*0.9999,'高量不破，，'),COLORYELLOW;
STICKLINE((C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9,O,C,1,0),COLORYELLOW;
倍阳不破:=CURRBARSCOUNT<100 AND BARSLAST((C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9)<22 AND (LLV(C,BARSLAST((C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9))>REF(L,BARSLAST((C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9)) OR LLV(L,BARSLAST((C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9))=REF(L,BARSLAST((C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9)));
STICKLINE(倍阳不破,REF(C,BARSLAST((C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9)),REF(C,BARSLAST((C>O*(1+1/100) OR C/REF(C,1)>1+1/100) AND VOL>REF(VOL,1)*1.9)),1.5,0),COLORGRAY,LINETHICK1;
PL5:=ZIG(3,5);
EN1:=PL5>REF(PL5,1) AND REF(PL5,1)<=REF(PL5,2) AND REF(PL5,2)<=REF(PL5,3);
EX1:=PL5<REF(PL5,1) AND REF(PL5,1)>=REF(PL5,2) AND REF(PL5,2)>=REF(PL5,3);
PL10:=ZIG(3,10);
EN2:=PL10>REF(PL10,1) AND REF(PL10,1)<=REF(PL10,2) AND REF(PL10,2)<=REF(PL10,3);
EX2:=PL10<REF(PL10,1) AND REF(PL10,1)>=REF(PL10,2) AND REF(PL10,2)>=REF(PL10,3);
PL20:=ZIG(3,20);
EN3:=PL20>REF(PL20,1) AND REF(PL20,1)<=REF(PL20,2) AND REF(PL20,2)<=REF(PL20,3);
EX3:=PL20<REF(PL20,1) AND REF(PL20,1)>=REF(PL20,2) AND REF(PL20,2)>=REF(PL20,3);
走强1:=BARSLAST(PL5<REF(PL5,1));
走弱1:=BARSLAST(PL5>REF(PL5,1));
走强2:=BARSLAST(PL10<REF(PL10,1));
走弱2:=BARSLAST(PL10>REF(PL10,1));
走强3:=BARSLAST(PL20<REF(PL20,1));
走弱3:=BARSLAST(PL20>REF(PL20,1));
ZTJZ5:=IF(PL10>REF(PL10,1),COUNT(EN1,走强2),0);
ZTJD5:=IF(PL10>REF(PL10,1),COUNT(EX1,走强2),0);
DTJZ5:=IF(PL10<REF(PL10,1),COUNT(EN1,走弱2),0);
DTJD5:=IF(PL10<REF(PL10,1),COUNT(EX1,走弱2),0);
ZTJZ10:=IF(PL20>REF(PL20,1),COUNT(EN2,走强3),0);
ZTJD10:=IF(PL20>REF(PL20,1),COUNT(EX2,走强3),0);
DTJZ10:=IF(PL20<REF(PL20,1),COUNT(EN2,走弱3),0);
DTJD10:=IF(PL20<REF(PL20,1),COUNT(EX2,走弱3),0);
T1:=ZTPRICE(REF(CLOSE,1),0.1) = C;
STICKLINE(T1,C,O,-1,0),COLORMAGENTA;
M144:=MA(CLOSE,144),COLORBROWN,LINETHICK2;
M233:=MA(CLOSE,233),COLORYELLOW,LINETHICK2;
M377:=MA(CLOSE,377),COLORCYAN,LINETHICK2;
M450:=MA(CLOSE,450),COLORGREEN,LINETHICK2;
M610:=MA(CLOSE,610),COLORRED,LINETHICK2;
A90:=(MA(COST(90),6)),DOTLINE,COLOR808040;
A70:=(MA(COST(70),6)),DOTLINE,COLOR808040;
M20:=MA(CLOSE,20),COLORWHITE,LINETHICK2;
T5:=REF(HHVBARS(HIGH,60),15)+15;
T60:=REF(HIGH,T5),COLORRED,NODRAW;
STICKLINE(BARSTATUS=2,T60,T60,2000,1),COLORBLUE;
DRAWTEXT(BARSTATUS=2,T60,'强势平台'),COLORYELLOW;
DOWN:=OPEN>CLOSE;
F:=COUNT(DOWN,6)=6;
AD:=COUNT(C<REF(C,1) ,6)=6;
BB:=(C<MA(C,30)*0.9);
E:=F AND AD AND BB;
AA:=MACD.DEA(12,26,9)<=0.6;
ZT4:=C>=REF(C,1)*1.099 AND C< MA(C,20)*1.15 AND C>MA(C,20) AND MACD.DEA(12,26,9)<=0.3 AND MACD.DEA(12,26,9)>=0;
ZT3:=C>=REF(C,1)*1.099 AND C< MA(C,20)*1.16 AND C>MA(C,20) AND AA AND C>=HHV(C,20) { AND V>REF(V,1)*1.3 } ;
 STICKLINE(REF(H,1)<L,L,REF(H,1),5,0),COLORGRAY;
C_: CONST(C),COLORLIRED,POINTDOT;{现价线};

## 副图

绿低量:=10;{WWW.178448.COM WEN98编制}

蓝低量:=50;

灰低量:=100;

H_L:=0.1*CONST(HHV(VOL,240));

{MAV10:MA(V,10),COLORYELLOW;}

VVOL:=IF(CURRBARSCOUNT=1 AND PERIOD=5,VOL*240/FROMOPEN,DRAWNULL);{模拟量}

STICKLINE(CURRBARSCOUNT=1 AND PERIOD=5,VVOL,0,1,-1),COLOR00C0C0;

量:VOL,VOLSTICK,COLORLIGRAY;

换手: VOL*10000/FINANCE(7),NODRAW,COLORGREEN; {DYNAINFO(37)*100}

全换手周期: SUMBARS(V,CAPITAL),NODRAW,COLORLIGREEN;{求完全换手到现在的周期数}

量比: V/REF(MA(V,5),1),COLORBROWN,NODRAW;

几倍: V/REF(V,1),COLORYELLOW,NODRAW;

倍数:=1.9;

倍量: VOL>=REF(V,1)*倍数 AND (IF(C<O,C>REF(C,1),1)),COLORYELLOW,NODRAW;

倍缩: REF(V,1)>=VOL*倍数,COLORMAGENTA,NODRAW;

平量: RANGE(V/REF(V,1),0.97,1.03) AND BARSCOUNT(V)>=2,COLORWHITE,NODRAW;

低量10: VOL=LLV(VOL,绿低量) AND BARSCOUNT(V)>=绿低量,COLORGREEN,NODRAW;

低量50: VOL=LLV(VOL,蓝低量) AND BARSCOUNT(V)>=蓝低量,COLORBLUE,NODRAW;

地量: VOL=LLV(VOL,灰低量) AND BARSCOUNT(V)>=灰低量,COLORGRAY,NODRAW;

V1:=VOL*0.95;{图标位置}

V2:=VOL*0.85;

STICKLINE(倍量, 0,V1,1,0),COLORYELLOW;

STICKLINE(平量,0,V1,1,0),COLORWHITE;

STICKLINE(低量10,0,V2,1,0),COLORLIGREEN;

STICKLINE(低量50,0,V2,1,0),COLORBLUE;

STICKLINE(地量,0,V2,1,0),COLORGRAY;

STICKLINE(倍缩,0,V*0.45,1,0),COLORMAGENTA;

STICKLINE(C<0 AND C >REF(C,1),0,V1,0,0),COLORRED;{假阴柱}

真阳或假阴:=C>O OR C>REF(C,1);

收阳:= REF(真阳或假阴,3);

倍量1:=REF(倍量,3);

高量:=REF(V,3)>=HHV(V,7);

三日不破:= LLV(C,3)>=REF(L,3);

价升:=COUNT(C>=REF(C,1),3)=3;{收盘价逐升}

量缩:=COUNT(V<=REF(V,1),3)=3;

连阳:= COUNT(真阳或假阴,3)=3;

倍量将军柱:= 倍量1 AND 三日不破 AND 收阳;

高量将军柱:= 高量 AND 三日不破 AND 收阳;

将军柱:= 倍量将军柱 OR 高量将军柱;

黄金柱:= 将军柱 AND 价升 AND 量缩 AND 连阳 ;{标准黄金柱}

STICKLINE(黄金柱,0.3*V,0.7*V,1,0),COLORRED; {红柱}

DRAWICON(黄金柱,V*1.5,1);

V100:= V<=LLV(V,100)*1.2 AND V>0 AND BARSCOUNT(V)>=100;

百日地量群:=COUNT(V100,5)>=3;

DRAWTEXT(FILTER(百日地量群,4),V+3*H_L,'地量群'),COLORGRAY;

长阴短柱:=C/REF(C,1)<=0.96 AND V<HHV(V,30)/1.9;

DRAWTEXT(长阴短柱 ,V+1.6*H_L,'！'),COLORLICYAN;

## 无腿单枪

JJ:=AMOUNT/VOL/100;

JYWTDQ:=C>O AND REF(C,1)>JJ AND O/L<1.015 AND H/C>=1.02;

ZYWTDQ:= MIN(C,O)/L<1.002 AND H/MAX(C,O)>=1.02;

WTDQ: (JYWTDQ OR ZYWTDQ) AND NOT(DYNAINFO(4)=0);

